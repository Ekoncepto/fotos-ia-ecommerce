# Test Design: Story 1.2

Date: 2025-09-04
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 7
- Unit tests: 1 (14%)
- Integration tests: 4 (57%)
- E2E tests: 2 (29%)
- Priority distribution: P0: 3, P1: 4, P2: 0

## Test Scenarios by Acceptance Criteria

### AC1: A página de login/cadastro deve apresentar uma opção principal: "Entrar com Google".

| ID           | Level       | Priority | Test                      | Justification            |
| ------------ | ----------- | -------- | ------------------------- | ------------------------ |
| 1.2-E2E-001 | E2E        | P0       | Verify that the "Sign in with Google" button is visible and clickable on the login page.     | Critical path validation |

### AC2: Clicar em "Entrar com Google" deve iniciar o fluxo de autenticação padrão do Google.

| ID           | Level       | Priority | Test                      | Justification            |
| ------------ | ----------- | -------- | ------------------------- | ------------------------ |
| 1.2-INT-001  | Integration | P0       | Verify that clicking the "Sign in with Google" button correctly redirects the user to the Google authentication page with the correct parameters (client ID, redirect URI, scope, state). | Multi-component flow     |

### AC3: Se um usuário se autenticar pela primeira vez, uma conta deve ser criada para ele automaticamente em nosso sistema.

| ID           | Level       | Priority | Test                      | Justification            |
| ------------ | ----------- | -------- | ------------------------- | ------------------------ |
| 1.2-INT-002  | Integration | P0       | Verify that after a successful Google authentication for a new user, a new user account is created in the database with the correct information from the Google profile. | Multi-component flow     |
| 1.2-UNIT-001 | Unit        | P1       | Test the function that maps the Google profile data to the internal user model.     | Pure validation logic    |

### AC4: Após o login, o usuário deve ser redirecionado para a página principal da aplicação.

| ID           | Level       | Priority | Test                      | Justification            |
| ------------ | ----------- | -------- | ------------------------- | ------------------------ |
| 1.2-INT-003  | Integration | P1       | Verify that after a successful login (for both new and existing users), the user is redirected to the main application page. | Routing logic validation |
| 1.2-E2E-002  | E2E         | P1       | A full end-to-end test where a user starts on the login page, authenticates with Google, and lands on the main application page. | Critical path validation |

## Negative Test Scenarios

| ID           | Level       | Priority | Test                      | Justification            |
| ------------ | ----------- | -------- | ------------------------- | ------------------------ |
| 1.2-INT-004  | Integration | P0       | Attempt to complete the OAuth flow with an invalid `state` parameter. The authentication should fail. | CSRF vulnerability test  |
| 1.2-INT-005  | Integration | P1       | Simulate a failure from the Google API (e.g., user denies permissions, invalid credentials). The application should handle the error gracefully and show an appropriate message to the user. | Resilience testing       |

## Risk Coverage

| Risk ID  | Mitigating Test Scenarios |
| -------- | ------------------------- |
| SEC-001  | 1.2-INT-001               |
| SEC-002  | 1.2-INT-001, 1.2-INT-004  |
| DATA-001 | 1.2-INT-002, 1.2-UNIT-001 |
| TECH-001 | 1.2-INT-005               |

## Recommended Execution Order

1. P0 Unit tests
2. P0 Integration tests
3. P0 E2E tests
4. P1 tests in order
