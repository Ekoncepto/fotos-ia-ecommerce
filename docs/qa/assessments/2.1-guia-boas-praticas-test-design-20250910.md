# Test Design: Story 2.1

Date: 2025-09-10
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 12
- Unit/UI tests: 6 (50%)
- Integration tests: 3 (25%)
- E2E tests: 3 (25%)
- Priority distribution: P0: 5, P1: 5, P2: 2

## Test Scenarios by Acceptance Criteria

### AC1: Exibir lista de dicas durante o upload

| ID              | Level | Priority | Test                                                                 | Justification |
|-----------------|-------|----------|----------------------------------------------------------------------|---------------|
| 2.1-UNIT-001    | Unit  | P0       | Render do componente de dicas exibe todas as mensagens previstas     | Core requirement |
| 2.1-UNIT-002    | Unit  | P1       | Componente de dicas não intercepta eventos de input/file             | Prevent regression |
| 2.1-UNIT-003    | Unit  | P1       | A11y: foco e leitura por SR corretos nas dicas                       | Accessibility |
| 2.1-E2E-001     | E2E   | P0       | Usuário vê dicas durante o fluxo de upload (seleção→progresso)       | UX-critical |

### AC2: Upload continua funcionando sem alterações

| ID              | Level | Priority | Test                                                                 | Justification |
|-----------------|-------|----------|----------------------------------------------------------------------|---------------|
| 2.1-E2E-002     | E2E   | P0       | Upload completo com arquivo válido; dicas presentes                   | Regression guard |
| 2.1-INT-001     | Int   | P1       | Handlers de upload disparam eventos esperados                         | Contract stability |

### AC3: Integração com processamento inalterada

| ID              | Level | Priority | Test                                                                 | Justification |
|-----------------|-------|----------|----------------------------------------------------------------------|---------------|
| 2.1-INT-002     | Int   | P1       | Evento após upload inicia pipeline de processamento como antes        | Contract stability |

### AC4: Sem regressões no fluxo de envio

| ID              | Level | Priority | Test                                                                 | Justification |
|-----------------|-------|----------|----------------------------------------------------------------------|---------------|
| 2.1-E2E-003     | E2E   | P0       | Fluxo completo upload→confirmação inalterado                          | Business continuity |
| 2.1-UNIT-004    | Unit  | P1       | Teste de snapshot/DOM: dicas não movem ou ocultam botões de upload   | Visual regression |

### AC5: Desempenho aceitável

| ID              | Level | Priority | Test                                                                 | Justification |
|-----------------|-------|----------|----------------------------------------------------------------------|---------------|
| 2.1-INT-003     | Int   | P2       | Comparar TTI/CLS com e sem componente de dicas                       | Perf budget |
| 2.1-UNIT-005    | Unit  | P2       | Componente não carrega assets pesados (lazy render)                  | Perf hygiene |

### Cross-cutting

| ID              | Level | Priority | Test                                                                 | Justification |
|-----------------|-------|----------|----------------------------------------------------------------------|---------------|
| 2.1-UNIT-006    | Unit  | P1       | i18n strings longas não quebram layout                               | Robustness |

## Risk Coverage

- TECH-001 (High): 2.1-E2E-002/003, 2.1-INT-001
- A11y: 2.1-UNIT-003
- PERF-001: 2.1-INT-003, 2.1-UNIT-005
- i18n/layout: 2.1-UNIT-006, 2.1-UNIT-004

## Recommended Execution Order

1. P0 E2E/unit: 2.1-E2E-001/002/003, 2.1-UNIT-001
2. P1 integration/unit: 2.1-INT-001/002, 2.1-UNIT-002/003/004/006
3. P2 perf: 2.1-INT-003, 2.1-UNIT-005

## Notes & Implementation Hints

- Isolar componente de dicas do formulário de upload (nenhum `preventDefault` incidental).
- Garantir foco navegável e leitura por leitores de tela (aria-label, role apropriado).
- Medir TTI antes/depois; evitar assets de imagens nas dicas.

## Test Artifact Pointers

- UI/Unit: apps/web/components/upload/__tests__/tips.test.tsx
- E2E: apps/web/tests/upload-with-tips.spec.ts

## Gate Block (pasteable)

test_design:
  scenarios_total: 12
  by_level:
    unit: 6
    integration: 3
    e2e: 3
  by_priority:
    p0: 5
    p1: 5
    p2: 2
  coverage_gaps: []

## Trace References

Story: docs/stories/2.1.guia-boas-praticas.md
Risk profile: docs/qa/assessments/2.1-guia-boas-praticas-risk-20250910.md

